
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Figure generation for a manuscript (using NbN CPW resonator data) &#8212; scraps 0.2.3 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="Example 2: Analysis of a resonator from W63" href="Example2_LotsOfData.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="figure-generation-for-a-manuscript-using-nbn-cpw-resonator-data">
<h1>Figure generation for a manuscript (using NbN CPW resonator data)<a class="headerlink" href="#figure-generation-for-a-manuscript-using-nbn-cpw-resonator-data" title="Permalink to this headline">¶</a></h1>
<p>by: Faustin W. Carter</p>
<p><em>Note: this has not been modified to by py3 compatible yet</em></p>
<p>Data is from a niobium-nitride CPW resonator fabricated at ANL by Trupti
Khaire. It was installed in a copper box, and wirebonded with gold bonds
to an impdence matching board that translated the signal from coax to
CPW. It is worth noting that the “power” listed in the data is the power
at the VNA output in dBm. The signal passes through about 60-70 dB of
attenuation on its way down to the resonator, and then experiences
between 40-50 dB amplification on the way back up. In other words, the
power axis is very much uncalibrated.</p>
<div class="section" id="import-some-stuff">
<h2>Import some stuff<a class="headerlink" href="#import-some-stuff" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="load-the-data-using-the-makereslist-tool-from-scraps">
<h2>Load the data using the makeResList tool from <code class="docutils literal"><span class="pre">scraps</span></code><a class="headerlink" href="#load-the-data-using-the-makereslist-tool-from-scraps" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="if-you-have-cached-data-skip-a-few-cells-down-to-load-up-previously-cached-data">
<h2><em>If you have cached data, skip a few cells down to “Load up previously cached data”</em><a class="headerlink" href="#if-you-have-cached-data-skip-a-few-cells-down-to-load-up-previously-cached-data" title="Permalink to this headline">¶</a></h2>
<p>The output is going to be a <code class="docutils literal"><span class="pre">dict</span></code>, keyword-indexed by the strings in
resNames</p>
<p>Now run fits on the resonator objects</p>
</div>
<div class="section" id="cache-fit-results-for-future-analysis">
<h2>Cache fit results for future analysis<a class="headerlink" href="#cache-fit-results-for-future-analysis" title="Permalink to this headline">¶</a></h2>
<p>Once you have run all the fits (which can take 5 or 10 minutes) it is a
good idea to cache that data. To do that, run the next cell down. Then,
the next time you come back, instead of reloading and refitting all the
data, you can just load the cached object back into memory.</p>
</div>
<div class="section" id="load-up-previously-cached-data">
<h2>Load up previously cached data<a class="headerlink" href="#load-up-previously-cached-data" title="Permalink to this headline">¶</a></h2>
<p>If you have a .pickle file from a previous run, you can load it up with
this cell, and skip everything above except for the first cell that
imports modules.</p>
</div>
</div>
<div class="section" id="now-we-can-make-a-plot-of-the-traces">
<h1>Now we can make a plot of the traces.<a class="headerlink" href="#now-we-can-make-a-plot-of-the-traces" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="_images/Example3_FiguresForManuscript_12_0.png"><img alt="_images/Example3_FiguresForManuscript_12_0.png" src="_images/Example3_FiguresForManuscript_12_0.png" style="width: 796px; height: 209px;" /></a>
</div>
<div class="section" id="use-the-mcmc-sampler-to-calculate-covariances-for-one-of-the-fits">
<h1>Use the MCMC sampler to calculate covariances for one of the fits<a class="headerlink" href="#use-the-mcmc-sampler-to-calculate-covariances-for-one-of-the-fits" title="Permalink to this headline">¶</a></h1>
<p>Running this next cell will take a few minutes (5 or 10, maybe)</p>
<div class="section" id="use-pygtc-to-plot-the-parameter-covariances">
<h2>Use <code class="docutils literal"><span class="pre">pygtc</span></code> to plot the parameter covariances<a class="headerlink" href="#use-pygtc-to-plot-the-parameter-covariances" title="Permalink to this headline">¶</a></h2>
<p>From here on out, you’ll need the <code class="docutils literal"><span class="pre">pygtc</span></code> package, or a similar
package like <code class="docutils literal"><span class="pre">corner</span></code> to view the covariances.</p>
<a class="reference internal image-reference" href="_images/Example3_FiguresForManuscript_16_0.png"><img alt="_images/Example3_FiguresForManuscript_16_0.png" src="_images/Example3_FiguresForManuscript_16_0.png" style="width: 501px; height: 502px;" /></a>
</div>
</div>
<div class="section" id="s21-fit-results-vs-temperature-and-power">
<h1>S21 fit results vs temperature and power<a class="headerlink" href="#s21-fit-results-vs-temperature-and-power" title="Permalink to this headline">¶</a></h1>
<p>Now, in order to look at the fit parameters as a function of power
and/or temperature, we first have to load all the fit parameters into a
custom dict of <code class="docutils literal"><span class="pre">pandas</span></code> DataFrames called a <code class="docutils literal"><span class="pre">ResonatorSweep</span></code> object.</p>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>-75.0</th>
      <th>-65.0</th>
      <th>-55.0</th>
      <th>-45.0</th>
      <th>-35.0</th>
      <th>-25.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>101.0</th>
      <td>2.342925e+04</td>
      <td>241.628635</td>
      <td>80.353994</td>
      <td>26.967362</td>
      <td>13.266917</td>
      <td>8.362478</td>
    </tr>
    <tr>
      <th>108.0</th>
      <td>1.155629e+12</td>
      <td>253.306191</td>
      <td>80.905558</td>
      <td>27.029800</td>
      <td>12.093033</td>
      <td>9.255624</td>
    </tr>
    <tr>
      <th>118.0</th>
      <td>6.169252e+06</td>
      <td>245.307879</td>
      <td>82.002065</td>
      <td>27.355258</td>
      <td>11.756653</td>
      <td>10.169799</td>
    </tr>
    <tr>
      <th>129.0</th>
      <td>1.013165e+08</td>
      <td>243.320043</td>
      <td>82.249325</td>
      <td>26.863802</td>
      <td>12.327247</td>
      <td>8.720828</td>
    </tr>
    <tr>
      <th>143.0</th>
      <td>1.020450e+08</td>
      <td>248.635163</td>
      <td>82.393823</td>
      <td>27.061348</td>
      <td>11.951223</td>
      <td>9.116620</td>
    </tr>
  </tbody>
</table>
</div><div class="section" id="now-we-can-look-at-the-fit-parameters-from-the-previous-step-vs-temperature-or-power">
<h2>Now we can look at the fit parameters from the previous step vs Temperature or Power<a class="headerlink" href="#now-we-can-look-at-the-fit-parameters-from-the-previous-step-vs-temperature-or-power" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/Example3_FiguresForManuscript_20_0.png"><img alt="_images/Example3_FiguresForManuscript_20_0.png" src="_images/Example3_FiguresForManuscript_20_0.png" style="width: 284px; height: 425px;" /></a>
</div>
</div>
<div class="section" id="fitting-secondary-fit-parameters-to-a-model">
<h1>Fitting secondary fit parameters to a model<a class="headerlink" href="#fitting-secondary-fit-parameters-to-a-model" title="Permalink to this headline">¶</a></h1>
<p>Now we will fit the frequency as a function of temperature and power to
a model and use the MCMC sampler to calculate the parameter covariances
for that fit.</p>
<div class="section" id="generate-model-parameters">
<h2>Generate model parameters<a class="headerlink" href="#generate-model-parameters" title="Permalink to this headline">¶</a></h2>
<p>Since <code class="docutils literal"><span class="pre">scraps</span></code> doesn’t have any models for secondary parameter fitting
built in (except for a very simple toy model, which we will use) we need
to specify some parameters and starting guesses.</p>
</div>
<div class="section" id="run-the-fit-with-the-toy-model">
<h2>Run the fit with the toy model<a class="headerlink" href="#run-the-fit-with-the-toy-model" title="Permalink to this headline">¶</a></h2>
<p>Here we are using the toy model included in
<code class="docutils literal"><span class="pre">scraps.fitsSweep.f0_tlsAndMBT</span></code>. It is definitely not physically valid
(except for maybe aluminum), and low weight should be placed on the
value of the fit parameters generated. However, it captures the overall
character of the data, and so it is useful as an example.</p>
<p>First we run an individual fit on two of the surfaces:  and
.</p>
</div>
<div class="section" id="plot-the-results-as-a-surface">
<h2>Plot the results as a surface<a class="headerlink" href="#plot-the-results-as-a-surface" title="Permalink to this headline">¶</a></h2>
<p>We use the 3D plotting functionality to look at the fit (black-dashed
mesh) overplotted on the semi-transparent surface that is the data.</p>
<a class="reference internal image-reference" href="_images/Example3_FiguresForManuscript_26_0.png"><img alt="_images/Example3_FiguresForManuscript_26_0.png" src="_images/Example3_FiguresForManuscript_26_0.png" style="width: 532px; height: 352px;" /></a>
<a class="reference internal image-reference" href="_images/Example3_FiguresForManuscript_26_1.png"><img alt="_images/Example3_FiguresForManuscript_26_1.png" src="_images/Example3_FiguresForManuscript_26_1.png" style="width: 532px; height: 352px;" /></a>
</div>
<div class="section" id="use-mcmc-to-look-at-the-fit-parameter-covariances">
<h2>Use MCMC to look at the fit parameter covariances<a class="headerlink" href="#use-mcmc-to-look-at-the-fit-parameter-covariances" title="Permalink to this headline">¶</a></h2>
<p>Running this next cell will take a few minutes.</p>
</div>
<div class="section" id="id1">
<h2>Use <code class="docutils literal"><span class="pre">pygtc</span></code> to plot the parameter covariances<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>As before, we’ll use <code class="docutils literal"><span class="pre">pygtc</span></code> to look at the parameter covariances. The
black dashed lines are the best-fit values from the least-squares
routine. It is nice to scale the numerical values before plotting, so as
before, we will do that.</p>
<a class="reference internal image-reference" href="_images/Example3_FiguresForManuscript_30_0.png"><img alt="_images/Example3_FiguresForManuscript_30_0.png" src="_images/Example3_FiguresForManuscript_30_0.png" style="width: 382px; height: 383px;" /></a>
<a class="reference internal image-reference" href="_images/Example3_FiguresForManuscript_30_1.png"><img alt="_images/Example3_FiguresForManuscript_30_1.png" src="_images/Example3_FiguresForManuscript_30_1.png" style="width: 379px; height: 380px;" /></a>
</div>
<div class="section" id="joint-fit-of-f-0-and-q-mathrm-i">
<h2>Joint fit of  and .<a class="headerlink" href="#joint-fit-of-f-0-and-q-mathrm-i" title="Permalink to this headline">¶</a></h2>
<p>It is possible to run a joint fit also. However, this will likely not
add very much information given that the shared parameters disagree by
amounts much larger than their variance between the two fits. In any
case, here is a joint fit demonstrated for completeness.</p>
<p>Now calculate the parameter covariances with MCMC.</p>
<p>And look at the result with <code class="docutils literal"><span class="pre">pygtc</span></code>. It’s pretty clear that the ‘qi’
part of the fit is dominating the results for whatever reason. Probably
this has to do with not scaling the uncertainties correctly or
something.</p>
<a class="reference internal image-reference" href="_images/Example3_FiguresForManuscript_36_0.png"><img alt="_images/Example3_FiguresForManuscript_36_0.png" src="_images/Example3_FiguresForManuscript_36_0.png" style="width: 384px; height: 385px;" /></a>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Figure generation for a manuscript (using NbN CPW resonator data)</a><ul>
<li><a class="reference internal" href="#import-some-stuff">Import some stuff</a></li>
<li><a class="reference internal" href="#load-the-data-using-the-makereslist-tool-from-scraps">Load the data using the makeResList tool from <code class="docutils literal"><span class="pre">scraps</span></code></a></li>
<li><a class="reference internal" href="#if-you-have-cached-data-skip-a-few-cells-down-to-load-up-previously-cached-data"><em>If you have cached data, skip a few cells down to “Load up previously cached data”</em></a></li>
<li><a class="reference internal" href="#cache-fit-results-for-future-analysis">Cache fit results for future analysis</a></li>
<li><a class="reference internal" href="#load-up-previously-cached-data">Load up previously cached data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#now-we-can-make-a-plot-of-the-traces">Now we can make a plot of the traces.</a></li>
<li><a class="reference internal" href="#use-the-mcmc-sampler-to-calculate-covariances-for-one-of-the-fits">Use the MCMC sampler to calculate covariances for one of the fits</a><ul>
<li><a class="reference internal" href="#use-pygtc-to-plot-the-parameter-covariances">Use <code class="docutils literal"><span class="pre">pygtc</span></code> to plot the parameter covariances</a></li>
</ul>
</li>
<li><a class="reference internal" href="#s21-fit-results-vs-temperature-and-power">S21 fit results vs temperature and power</a><ul>
<li><a class="reference internal" href="#now-we-can-look-at-the-fit-parameters-from-the-previous-step-vs-temperature-or-power">Now we can look at the fit parameters from the previous step vs Temperature or Power</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fitting-secondary-fit-parameters-to-a-model">Fitting secondary fit parameters to a model</a><ul>
<li><a class="reference internal" href="#generate-model-parameters">Generate model parameters</a></li>
<li><a class="reference internal" href="#run-the-fit-with-the-toy-model">Run the fit with the toy model</a></li>
<li><a class="reference internal" href="#plot-the-results-as-a-surface">Plot the results as a surface</a></li>
<li><a class="reference internal" href="#use-mcmc-to-look-at-the-fit-parameter-covariances">Use MCMC to look at the fit parameter covariances</a></li>
<li><a class="reference internal" href="#id1">Use <code class="docutils literal"><span class="pre">pygtc</span></code> to plot the parameter covariances</a></li>
<li><a class="reference internal" href="#joint-fit-of-f-0-and-q-mathrm-i">Joint fit of  and .</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Example2_LotsOfData.html" title="previous chapter">Example 2: Analysis of a resonator from W63</a></li>
      <li>Next: <a href="api.html" title="next chapter">API</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Faustin W. Carter.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/Example3_FiguresForManuscript.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>