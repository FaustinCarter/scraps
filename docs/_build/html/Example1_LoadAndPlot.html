
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Example 1: Load one file into the Resonator class &#8212; scraps 0.2.3 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example 2: Analysis of a resonator from W63" href="Example2_LotsOfData.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="example-1-load-one-file-into-the-resonator-class">
<h1>Example 1: Load one file into the <code class="docutils literal"><span class="pre">Resonator</span></code> class<a class="headerlink" href="#example-1-load-one-file-into-the-resonator-class" title="Permalink to this headline">¶</a></h1>
<p><strong>By: Faustin Carter, 2016, updated 2017</strong></p>
<p>This notebook imports the data from one Agilent file, creates a
<code class="docutils literal"><span class="pre">Resonator</span></code> object, runs a fitting routine, and then plots the data
and fit curves in a nice way.</p>
<p>Once you’ve understood this example, you should be able to replicate it
with your own data simply be writing a custom <code class="docutils literal"><span class="pre">process_file</span></code> function
and updating the code that finds the datafile.</p>
<div class="section" id="load-up-the-scraps-modules">
<h2>Load up the <code class="docutils literal"><span class="pre">scraps</span></code> modules<a class="headerlink" href="#load-up-the-scraps-modules" title="Permalink to this headline">¶</a></h2>
<p>You’ll need to change the path to reflect wherever you stored the code</p>
</div>
<div class="section" id="load-a-file-and-process-the-data">
<h2>Load a file and process the data<a class="headerlink" href="#load-a-file-and-process-the-data" title="Permalink to this headline">¶</a></h2>
<p>This unpacks the file data into a dict objects. This block of code is
the only thing you need to change to make this work with your data.</p>
<p>The data dict has the following quantities:</p>
<ul class="simple">
<li><strong>I, Q, and freq</strong>: numpy arrays of data from the VNA file</li>
<li><strong>name</strong>: an arbitrary string describing the resonator. This is
description of the physical object. So if you run two sweeps on the
same resonator at different powers or temperatures, you should give
them the same name.</li>
<li><strong>pwr, temp</strong>: floats that describe the power in dB and the
temperature in K that the measurement was taken at.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.022739</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.022687</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02265</span> <span class="p">,</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">0.063827</span><span class="p">,</span>  <span class="mf">0.063836</span><span class="p">,</span>
        <span class="mf">0.063869</span><span class="p">]),</span>
 <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.062457</span><span class="p">,</span>  <span class="mf">0.062449</span><span class="p">,</span>  <span class="mf">0.062447</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">0.02939</span> <span class="p">,</span>  <span class="mf">0.029329</span><span class="p">,</span>  <span class="mf">0.02928</span> <span class="p">]),</span>
 <span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span>  <span class="mf">8.17088000e+09</span><span class="p">,</span>   <span class="mf">8.17088400e+09</span><span class="p">,</span>   <span class="mf">8.17088800e+09</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
         <span class="mf">8.17887200e+09</span><span class="p">,</span>   <span class="mf">8.17887600e+09</span><span class="p">,</span>   <span class="mf">8.17888000e+09</span><span class="p">]),</span>
 <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;RES-1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;pwr&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span>
 <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="mf">0.113</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="make-a-resonator-object">
<h2>Make a <code class="docutils literal"><span class="pre">Resonator</span></code> object<a class="headerlink" href="#make-a-resonator-object" title="Permalink to this headline">¶</a></h2>
<p>You can either create a resonator object directly, or use the
<code class="docutils literal"><span class="pre">makeResFromData</span></code> helper tool, which takes the data dict you made
earlier as an argument. The <code class="docutils literal"><span class="pre">makeResFromData</span></code> tool also allows you to
simultaneously fit the data to a model, by passing the model along.</p>
<p><code class="docutils literal"><span class="pre">makeResFromData</span></code> returns a resonator object, as well as the
temperature rounded to the nearest 5 mK and the power. This is for
convenience when dealing with large numbers of <code class="docutils literal"><span class="pre">Resonator</span></code> objects
programmatically.</p>
<p>The <code class="docutils literal"><span class="pre">Resonator</span></code> object takes the I, Q, and freq data and calculates
magnitude and phase.</p>
<p>The <code class="docutils literal"><span class="pre">cmplxIQ_params</span></code> function sets up a <code class="docutils literal"><span class="pre">lmfit</span></code> <code class="docutils literal"><span class="pre">Parameters</span></code>
object which can later be passed to a fitting function. It also tries to
guess the baseline of the magnitude and the electrical delay (i.e.
baseline) of the phase, as well as starting values for frequency and
quality factor. The <code class="docutils literal"><span class="pre">cmplxIQ_fit</span></code> function is model function that uses
the parameters defined in <code class="docutils literal"><span class="pre">cmplxIQ_params</span></code> that is passed to the
<code class="docutils literal"><span class="pre">do_lmfit</span></code> or <code class="docutils literal"><span class="pre">do_emcee</span></code> methods of the <code class="docutils literal"><span class="pre">Resonator</span></code> object.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Temperature =  0.113
Power =  -10.0
Do fit results exist for the first object?  False
Do fit results exist for the second object?  True
Do fit results exist for the first object?  True
Do fit results exist for the second object?  True
Guess =  8174865993.0  Hz
Best fit =  8174865670.34  Hz
Best fit with different qc guess =  8174865670.34  Hz
</pre></div>
</div>
</div>
<div class="section" id="make-a-pretty-plot">
<h2>Make a pretty plot<a class="headerlink" href="#make-a-pretty-plot" title="Permalink to this headline">¶</a></h2>
<p>Fits aren’t worth anything if you don’t plot the results!!</p>
<a class="reference internal image-reference" href="_images/Example1_LoadAndPlot_9_0.png"><img alt="_images/Example1_LoadAndPlot_9_0.png" src="_images/Example1_LoadAndPlot_9_0.png" style="width: 605px; height: 278px;" /></a>
</div>
<div class="section" id="find-the-maximum-liklhood-estimate-of-the-fit-params-using-emcee">
<h2>Find the maximum liklhood estimate of the fit params using <code class="docutils literal"><span class="pre">emcee</span></code><a class="headerlink" href="#find-the-maximum-liklhood-estimate-of-the-fit-params-using-emcee" title="Permalink to this headline">¶</a></h2>
<p>Let’s use the built-in <code class="docutils literal"><span class="pre">emcee</span></code> hooks to compare the results of the
<code class="docutils literal"><span class="pre">lmfit</span></code> values with the maximum liklihood values for the fit
parameters.</p>
<pre class="literal-block">
Does an emcee chain exist?  True

Head of chains:
            df            f0            qc             qi     gain0     gain1  0  88693.25624  8.174866e+09  48824.594021  284047.107889  0.068197  1.039969
1  88693.25624  8.174866e+09  48824.594021  284047.107889  0.068197  1.039969
2  88693.25624  8.174866e+09  48824.594021  284047.107889  0.068197  1.039969
3  88693.25624  8.174866e+09  48824.594021  284047.107889  0.068197  1.039969
4  88693.25624  8.174866e+09  48824.594021  284047.107889  0.068197  1.039969

         gain2    pgain0       pgain1
0  1107.755048  4.317309 -1563.863741
1  1107.755048  4.317309 -1563.863741
2  1107.755048  4.317309 -1563.863741
3  1107.755048  4.317309 -1563.863741
4  1107.755048  4.317309 -1563.863741

Perecent difference:
[('df', -0.0005044574162677047),
 ('f0', 5.9165526894802568e-09),
 ('qc', -0.00042210636481046374),
 ('qi', 0.0040312688997595006),
 ('gain0', 6.8081838833118757e-05),
 ('gain1', 0.0034954527806059987),
 ('gain2', -0.010104059690110649),
 ('pgain0', 3.5469655585706252e-06),
 ('pgain1', 9.9454230765084369e-05)]
</pre>
</div>
<div class="section" id="make-a-sweet-giant-triangle-confusogram-of-your-emcee-results">
<h2>Make a sweet giant triangle confusogram of your <code class="docutils literal"><span class="pre">emcee</span></code> results.<a class="headerlink" href="#make-a-sweet-giant-triangle-confusogram-of-your-emcee-results" title="Permalink to this headline">¶</a></h2>
<p>If you don’t have <code class="docutils literal"><span class="pre">pygtc</span></code> installed, open a terminal and type
<code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pygtc</span></code>. Go ahead, I’ll wait…</p>
<a class="reference internal image-reference" href="_images/Example1_LoadAndPlot_15_0.png"><img alt="_images/Example1_LoadAndPlot_15_0.png" src="_images/Example1_LoadAndPlot_15_0.png" style="width: 549px; height: 535px;" /></a>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Example 1: Load one file into the <code class="docutils literal"><span class="pre">Resonator</span></code> class</a><ul>
<li><a class="reference internal" href="#load-up-the-scraps-modules">Load up the <code class="docutils literal"><span class="pre">scraps</span></code> modules</a></li>
<li><a class="reference internal" href="#load-a-file-and-process-the-data">Load a file and process the data</a></li>
<li><a class="reference internal" href="#make-a-resonator-object">Make a <code class="docutils literal"><span class="pre">Resonator</span></code> object</a></li>
<li><a class="reference internal" href="#make-a-pretty-plot">Make a pretty plot</a></li>
<li><a class="reference internal" href="#find-the-maximum-liklhood-estimate-of-the-fit-params-using-emcee">Find the maximum liklhood estimate of the fit params using <code class="docutils literal"><span class="pre">emcee</span></code></a></li>
<li><a class="reference internal" href="#make-a-sweet-giant-triangle-confusogram-of-your-emcee-results">Make a sweet giant triangle confusogram of your <code class="docutils literal"><span class="pre">emcee</span></code> results.</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter">Installation</a></li>
      <li>Next: <a href="Example2_LotsOfData.html" title="next chapter">Example 2: Analysis of a resonator from W63</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Faustin W. Carter.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/Example1_LoadAndPlot.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>